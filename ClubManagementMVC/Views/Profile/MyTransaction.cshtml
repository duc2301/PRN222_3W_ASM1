@using ClubManagement.Service.DTOs.ResponseDTOs
@model List<PaymentResponseDTO>

@{
    ViewData["Title"] = "Lịch sử giao dịch";
    ViewData["ActivePage"] = "Transactions";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<style>
    .trans-card {
        background: #fff;
        border-radius: 20px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.05);
        border: none;
    }
</style>

<div class="container py-5">
    <div class="row">
        <partial name="ProfileSidebar" />

        <div class="col-md-9">
            <h4 class="fw-bold mb-4">Lịch sử thanh toán</h4>

            <div class="trans-card p-4">
                @if (Model != null && Model.Any())
                {
                    <div class="table-responsive">
                        <table class="table table-hover align-middle">
                            <thead class="bg-light text-muted small text-uppercase">
                                <tr>
                                    <th class="border-0 rounded-start ps-4">Mã GD</th>
                                    <th class="border-0">Nội dung</th>
                                    <th class="border-0">Thời gian</th>
                                    <th class="border-0 text-end">Số tiền</th>
                                    <th class="border-0 rounded-end text-center">Trạng thái</th>
                                </tr>
                            </thead>
                            <tbody>
                                @foreach (var item in Model.OrderByDescending(x => x.PaymentDate))
                                {
                                    <tr>
                                        <td class="ps-4 fw-bold text-muted small">#@item.PaymentId</td>
                                        <td>
                                            <div class="fw-bold text-dark">@item.FeeTitle</div>
                                            <div class="small text-muted">@item.ClubName</div>
                                        </td>
                                        <td class="text-secondary small">
                                            @(item.PaymentDate?.ToString("HH:mm dd/MM/yyyy") ?? "N/A")
                                        </td>
                                        <td class="text-end fw-bold">
                                            -@item.Amount.ToString("N0")đ
                                        </td>
                                        <td class="text-center">
                                            @if (item.Status?.ToLower() == "success" || item.Status?.ToLower() == "completed" || item.Status == "Paid")
                                            {
                                                <span class="badge bg-success bg-opacity-10 text-success px-3 py-2 rounded-pill">Thành công</span>
                                            }
                                            else if (item.Status?.ToLower() == "pending")
                                            {
                                                <span class="badge bg-warning bg-opacity-10 text-warning px-3 py-2 rounded-pill">Đang chờ</span>
                                            }
                                            else
                                            {
                                                <span class="badge bg-danger bg-opacity-10 text-danger px-3 py-2 rounded-pill">@item.Status</span>
                                            }
                                        </td>
                                    </tr>
                                }
                            </tbody>
                        </table>
                    </div>
                }
                else
                {
                    <div class="text-center py-5">
                        <i class="bi bi-receipt text-muted" style="font-size: 3rem;"></i>
                        <p class="mt-3 text-muted">Chưa phát sinh giao dịch nào.</p>
                    </div>
                }
            </div>
        </div>
    </div>
</div>